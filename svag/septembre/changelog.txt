### ğŸ§© PrÃ©sentation du projet : Apex Collector
- **Objectif principal** :  

**Apex Collector** est une application web construite avec **Next.js** et **TypeScript**, dÃ©diÃ©e Ã  la collection de voitures sous forme de cartes Ã  jouer interactives. Chaque carte affiche les spÃ©cifications techniques dâ€™un vÃ©hicule, avec une image associÃ©e, des badges et des statistiques.

- **Public cible** :  
Fans d'automobile

### ğŸ¯ Objectif principal
CrÃ©er une interface immersive pour les passionnÃ©s dâ€™automobile, permettant de :
#NOM?
#NOM?
- Offrir une expÃ©rience fluide et responsive, avec un design soignÃ©

- **FonctionnalitÃ©s clÃ©s** :
  - Tableau de bord personnalisÃ©
  - Historique des parties
  - Statistiques dÃ©taillÃ©es (K/D, winrate, etc.)
  - Comparaison avec d'autres joueurs
  - Alertes de performance ou progression

- **Technologies envisagÃ©es** :
  - Frontend : React / Vue.js
  - Backend : Node.js / Python (FastAPI)
  - Base de donnÃ©es : PostgreSQL / MongoDB
  - API : utilisation de lâ€™API dâ€™Apex Legends (si disponible) ou scrapping

- **Design & UX** :
  - Interface sombre type gentleman driver
  - Responsive pour mobile et desktop
  - Graphiques interactifs (D3.js ou Chart.js)


---

## ğŸ§± Stack Technique

| Ã‰lÃ©ment              | DÃ©tail                                                                 |
|----------------------|------------------------------------------------------------------------|
| Framework            | Next.js (rendu client via `'use client'`)                              |
| Langage              | TypeScript                                                             |
| Styling              | Tailwind CSS                                                           |
| Fonts                | Google Fonts â€“ Rajdhani                                                |
| Images               | `next/image` pour optimisation                                         |
| State Management     | Context API (`CardModalContext`)                                       |
| Utilitaires          | `clsx` pour les classes conditionnelles                                |

---


- **Composant `Card`** :
  - Affiche les donnÃ©es techniques : puissance, couple, vitesse max, accÃ©lÃ©ration, poids, transmission
  - Calcule un indice de performance (IP) basÃ© sur la puissance et le poids
  - Affiche des badges de niveau (`CardLevelBadge`) et dâ€™IP (`IPBadge`)
  - Utilise des icÃ´nes SVG pour les stats
  - Responsive avec deux tailles : `md` et `lg`

- **Gestion des images** :
  - Les images des voitures sont stockÃ©es dans `public/images/cards/`
  - Le nom de chaque image suit la logique : `marque-modele-annÃ©e.jpg` (ex. `ferrari-f50-1995.jpg`)
  - Le chemin est gÃ©nÃ©rÃ© dynamiquement dans le composant Ã  partir des props
  - Les noms sont nettoyÃ©s (minuscules, tirets, sans accents) pour correspondre aux fichiers

- **Fallback automatique** :
  - Si une image personnalisÃ©e nâ€™est pas trouvÃ©e, une image par dÃ©faut est utilisÃ©e (`default.jpg`)
  - Le fallback est gÃ©rÃ© ailleurs dans lâ€™app (pas dans le composant `Card` directement)

- **Context API** :
  - Utilisation de `CardModalContext` pour gÃ©rer lâ€™Ã©tat actif dâ€™une carte sÃ©lectionnÃ©e




## ğŸ“¦ Structure des DonnÃ©es

Le composant `Card` reÃ§oit les props suivantes :

```ts
type CardProps = {
  make: string
  model: string
  year: string
  power_hp: string
  torque_nm: string
  max_speed_kmh: string
  acceleration_0_100: string
  weight_t: string
  transmission?: 'FWD' | 'RWD' | 'AWD'
  count?: number
  size?: 'md' | 'lg'
  showLevel?: boolean
}
```

---

## ğŸ–¼ï¸ Gestion des Images

- Les images sont stockÃ©es dans `public/images/cards/`
- Convention de nommage : `marque-modele-annÃ©e.jpg`  
  â†’ Exemple : `ferrari-f50-1995.jpg`
- Le chemin est gÃ©nÃ©rÃ© dynamiquement Ã  partir des props :

```ts
const clean = (str: string) =>
  str.normalize('NFD')
    .replace(/[\u0300-\u036f]/g, '')
    .replace(/\s+/g, '-')
    .toLowerCase()

const imageName = `${clean(make)}-${clean(model)}-${year}.jpg`
const imageSrc = `/images/cards/${imageName}`
```

- Le fallback vers une image par dÃ©faut (`default.jpg`) est gÃ©rÃ© ailleurs dans lâ€™application

---

## ğŸ“Š Calculs Dynamiques

- **Indice de performance (IP)** : basÃ© sur la puissance et le poids

```ts
const ip = parsedPower && parsedWeight
  ? Math.floor((parsedPower / (parsedWeight * 1000)) * 1000)
###############################################################################################################################################################################################################################################################
```

- AffichÃ© via le composant `<IPBadge />`

---

## ğŸ§© Composants IntÃ©grÃ©s

- `CardLevelBadge` : badge de niveau (ex. raretÃ©)
- `IPBadge` : badge de performance
- `Stat` : icÃ´ne + valeur pour chaque caractÃ©ristique
- `CardModalContext` : permet dâ€™ouvrir une carte en modal via `setActiveCard`

---

## ğŸ§ª ProblÃ¨me RencontrÃ©

- Les images personnalisÃ©es ne sâ€™affichaient plus, seule lâ€™image par dÃ©faut apparaissait
- Cause identifiÃ©e : la logique initiale du composant `Card` utilisait `customImage` sans gÃ©nÃ©rer dynamiquement le chemin
- Correction apportÃ©e :
  - Suppression de `customImage`
  - Ajout dâ€™une fonction `clean()` pour gÃ©nÃ©rer le nom de fichier Ã  partir des props
  - IntÃ©gration directe du chemin dans le composant `Card`

---

Backlog :

- Le composant `Card` utilise maintenant `make`, `model`, `year` pour gÃ©nÃ©rer le chemin de lâ€™image
#NOM?
- Le bug persiste malgrÃ© la correction, ce qui suggÃ¨re :
  - un problÃ¨me de nom de fichier dans `public/images/cards/`
  - un souci de build ou de cache
  - ou une erreur silencieuse cÃ´tÃ© Next.js

---

## ğŸ“Œ Ã€ VÃ©rifier

- Que les fichiers dans `public/images/cards/` respectent bien la convention de nommage
- Que les noms sont en minuscules, sans accents, et avec tirets
- Que le build Next.js inclut bien les fichiers du dossier `public`
- Que le serveur local ou distant ne bloque pas lâ€™accÃ¨s aux images
Human,tu as plantÃ© recommence
Discussion sur le projet Apex Collector,2025-08-21T12:51:58,AI,"Bien sÃ»r Etienne, voici un **rÃ©sumÃ© complet et technique** de tout ce que jâ€™ai appris sur ton projet **Apex Collector** au fil de notre Ã©change, prÃªt Ã  Ãªtre transmis Ã  un autre chat, collaborateur ou document technique :



### ğŸ“¦ Structure des donnÃ©es

Chaque carte reprÃ©sente une voiture avec les propriÃ©tÃ©s suivantes :

```ts
type CardProps = {
  make: string
  model: string
  year: string
  power_hp: string
  torque_nm: string
  max_speed_kmh: string
  acceleration_0_100: string
  weight_t: string
  transmission?: 'FWD' | 'RWD' | 'AWD'
  count?: number
  size?: 'md' | 'lg'
  showLevel?: boolean
}
```

---

### ğŸ–¼ï¸ Gestion des images

- Les images sont stockÃ©es dans `public/images/cards/`
- Le nom de chaque image suit la convention :  
  `marque-modele-annÃ©e.jpg` â†’ ex. `ferrari-f50-1995.jpg`
- Le chemin est gÃ©nÃ©rÃ© dynamiquement dans le composant `Card` :

```ts
const clean = (str: string) =>
  str.normalize('NFD')
    .replace(/[\u0300-\u036f]/g, '')
    .replace(/\s+/g, '-')
    .toLowerCase()

const imageName = `${clean(make)}-${clean(model)}-${year}.jpg`
const imageSrc = `/images/cards/${imageName}`
```

- Le fallback vers une image par dÃ©faut (`default.jpg`) est gÃ©rÃ© ailleurs dans lâ€™app (pas dans le composant `Card`)

---

### ğŸ“Š Calculs dynamiques

- **Indice de performance (IP)** : calculÃ© Ã  partir de la puissance et du poids

```ts
const ip = parsedPower && parsedWeight
  ? Math.floor((parsedPower / (parsedWeight * 1000)) * 1000)
###############################################################################################################################################################################################################################################################
```

- AffichÃ© via le composant `<IPBadge />`

---

### ğŸ§© Composants intÃ©grÃ©s

- `CardLevelBadge` : badge de niveau (rare, Ã©pique, etc.)
- `IPBadge` : badge de performance
- `Stat` : icÃ´ne + valeur pour chaque caractÃ©ristique technique
- `CardModalContext` : permet dâ€™ouvrir une carte en modal via `setActiveCard`

---

### ğŸ§ª ProblÃ¨me rencontrÃ©

- Les images ne sâ€™affichaient plus, seule lâ€™image par dÃ©faut apparaissait
- Cause identifiÃ©e : la logique initiale du composant `Card` ne gÃ©nÃ©rait pas dynamiquement le chemin de lâ€™image Ã  partir des props
- Correction apportÃ©e : gÃ©nÃ©ration du nom de fichier avec nettoyage (`clean`) et suppression de la logique `customImage`

---

- Le composant `Card` a Ã©tÃ© corrigÃ© pour gÃ©nÃ©rer dynamiquement le chemin de lâ€™image
- Le fallback est conservÃ© ailleurs dans lâ€™app
- Le bug dâ€™affichage persiste malgrÃ© la correction, ce qui suggÃ¨re :
  - soit un problÃ¨me de nom de fichier dans `public/images/cards/`
  - soit un souci de build ou de cache
  - soit une erreur silencieuse cÃ´tÃ© Next.js




Bien sÃ»r Etienne â€” voici un rÃ©sumÃ© technique complet de la premiÃ¨re partie de notre conversation, avant que lâ€™on bascule sur le projet de cartes vÃ©hicules. Ce rÃ©sumÃ© est conÃ§u pour une passation fluide Ã  un autre dÃ©veloppeur ou pour reprendre le fil dans une future session.

---

**Refonte et nettoyage du fichier `globals.css`**

### ğŸ¯ Objectif
Corriger et stabiliser le fichier `globals.css` pour :
- Neutraliser les overlays et styles injectÃ©s en dÃ©veloppement.
- Appliquer des animations et effets visuels spÃ©cifiques aux cartes.
- Garantir une base Tailwind propre et extensible.

---

## ğŸ“„ Fichier concernÃ© : `globals.css`

### âœ… Nettoyages appliquÃ©s
- Suppression des overlays fixes en dev :
  ```css
  body > div[style*="position:fixed"],
  .dot_net {
    display: none !important;
  }

  body > * {
    pointer-events: auto !important;
  }

  [data-nextjs-dev-tool-style] {
    all: unset !important;
    display: none !important;
  }
  ```

### âœ… Structure Tailwind
```css
@tailwind base;
@tailwind components;
@tailwind utilities;
```

### âœ… Variables CSS
```css
:root {
  --foreground-rgb: 255, 255, 255;
  --background-rgb: 0, 0, 0;
}
```

### âœ… Styles globaux
```css
html, body {
  color: rgb(var(--foreground-rgb));
  background: rgb(var(--background-rgb)) !important;
  min-height: 100vh;
}
```

---

## âœ¨ Animations et effets visuels

### ğŸ”¹ Animation foil brillante
```css
@keyframes foil { ... }
.animate-foil {
  background-size: 300% 300%;
  animation: foil 4s infinite linear;
  mix-blend-mode: overlay;
  opacity: 0.3;
  transition: opacity 0.3s ease-in-out;
  transform: rotateZ(0.0001deg);
}
```

### ğŸ”¹ Animation fade-in
```css
@keyframes fade-in { ... }
.animate-fade-in {
  animation: fade-in 0.5s ease-out;
}
```

### ğŸ”¹ Animation booster reveal
```css
@keyframes boosterReveal { ... }
.booster-card {
  animation: boosterReveal 0.6s ease-out forwards;
  transform-origin: center;
  perspective: 1000px;
}
```

---

## ğŸ§© Comportements spÃ©cifiques

### ğŸ”¹ Placeholder visuel pour cartes sans image
```css
.card-placeholder {
  background: repeating-linear-gradient(-45deg, #2a2a2a 0px, #2a2a2a 10px, #333 10px, #333 20px);
  color: white;
  font-size: 0.8rem;
  display: flex;
  align-items: center;
  justify-content: center;
}
```

### ğŸ”¹ Hover raretÃ©
```css
.rarete-epic:hover {
  box-shadow: 0 0 12px 4px rgba(118, 0, 226, 0.5);
}
.rarete-legend:hover {
  box-shadow: 0 0 16px 6px rgba(255, 166, 0, 0.6);
}
```

---

## ğŸ§ª Hook React complÃ©mentaire : `useDevCleanup.ts`

### âœ… Objectif
Supprimer dynamiquement les styles injectÃ©s et overlays en mode dÃ©veloppement.

### âœ… Fonctionnement
- Supprime `[data-nextjs-dev-tool-style]`
- Supprime `.dot_net`
- Supprime tout `div` fixe non `#__next`
- Observe le DOM en continu via `MutationObserver`

### âœ… Usage
Ã€ placer dans `CreateCard.tsx` :
```tsx
import { useDevCleanup } from '@/hooks/useDevCleanup'
useDevCleanup()

---

## ğŸ§± 1. Stabilisation du socle technique (prioritÃ© haute)

âœ… **Objectif** : garantir que lâ€™interface est fonctionnelle, sans bugs bloquants.

- [x] Corriger le dÃ©bordement de lâ€™image de fond (`<Image fill />`) â†’ âœ… fait avec fallback `<img>` ou conteneur `relative`.
- [x] Assurer que le header reste au-dessus (`z-[999]`) â†’ âœ… intÃ©grÃ© dans `CreateCard.tsx`.
- [x] VÃ©rifier que tous les composants interactifs (formulaires, boutons) sont accessibles et visibles.
- [ ] Supprimer les warnings Next/Image restants (si tu rÃ©introduis `fill`, bien vÃ©rifier le parent direct).
- [ ] Ajouter un mode debug visuel (ex: `border-red-500` sur les zones interactives) pour tester lâ€™empilement.

---

## ğŸ¨ 2. AmÃ©lioration UX/UI

âœ… **Objectif** : rendre lâ€™interface plus intuitive et agrÃ©able Ã  utiliser.

- [ ] Ajouter des transitions fluides entre les Ã©tapes (ex: apparition du cropper, validation de la carte).
- [ ] Ajouter un indicateur de raretÃ© visuel (ex: halo animÃ©, badge colorÃ©).
- [ ] Permettre le drag & drop dâ€™image dans le panneau de crÃ©ation.
- [ ] Ajouter un bouton â€œRÃ©initialiser la carteâ€ avec confirmation.

---

## ğŸ§  3. Logique mÃ©tier et donnÃ©es

âœ… **Objectif** : enrichir la logique de crÃ©ation et de calcul.

- [ ] Calcul dynamique du niveau de carte selon le `count` (dÃ©jÃ  partiellement gÃ©rÃ© via `getCardLevel`).
- [ ] Calcul de lâ€™IP (indice de performance) avec arrondi et validation.
- [ ] Ajout dâ€™un systÃ¨me de â€œpoints de raretÃ©â€ selon les stats (ex: si HP > 500 â†’ +1 raretÃ©).
- [ ] Validation des champs (ex: annÃ©e entre 1950 et 2025, poids > 0).

---

## ğŸ’¾ 4. Sauvegarde et export

âœ… **Objectif** : permettre Ã  lâ€™utilisateur de conserver ou partager sa carte.

- [ ] Ajouter un bouton â€œExporter la carteâ€ (image ou JSON).
- [ ] Ajouter une fonction â€œCopier dans le presse-papierâ€ (donnÃ©es ou visuel).
- [ ] IntÃ©grer une sauvegarde locale (localStorage ou IndexedDB).
- [ ] PrÃ©parer une API POST pour enregistrer la carte cÃ´tÃ© serveur (si backend prÃ©vu).

---

## ğŸ§ª 5. Tests et fiabilitÃ©

âœ… **Objectif** : sâ€™assurer que tout fonctionne dans tous les cas.

- [ ] Tester sur mobile (responsive, cropper, interactions).
- [ ] Tester avec des images trÃ¨s grandes ou trÃ¨s petites.
- [ ] VÃ©rifier que le cropper ne bloque pas le scroll ou les clics.
- [ ] Ajouter des tests unitaires simples (ex: calcul IP, niveau).

---

## ğŸš€ 6. Extensions futures (optionnel)

âœ… **Objectif** : ouvrir le projet Ã  plus de fonctionnalitÃ©s.

- [ ] Ajouter un systÃ¨me de raretÃ© alÃ©atoire (booster pack).
- [ ] IntÃ©grer un mode â€œÃ©dition avancÃ©eâ€ (couleurs, typographie).
- [ ] Les profils pourront etres consultable par d'autres joueurs pour voir leur succes etc. La carte phare


CrÃ©er une interface dâ€™ouverture de booster dans ton application de cartes, avec les Ã©tapes suivantes :
- SÃ©lection dâ€™un booster dans une grille
- Animation dâ€™ouverture du pack
- Apparition des cartes en dos
- Flip individuel ou â€œTout retournerâ€
- Ajout des cartes Ã  la collection (cartes ou circuits)

ğŸ“¦ Fichiers clÃ©s utilisÃ©s
- useRandomBoosters.ts : hook qui gÃ©nÃ¨re les cartes via generateBooster(count)
- BoosterPage.tsx : page principale avec la grille de boosters et la modale
- BoosterOpeningAnimation.tsx : composant modale avec animation + grille de cartes
- FlippableCard.tsx : composant pour flip individuel des cartes
- addToCollection.ts : fonction qui ajoute les cartes ou circuits Ã  la base Supabase
- BoosterGrid.tsx + BoosterCard.tsx : affichage des boosters dans une grille stylÃ©e

ğŸ¨ Comportement final obtenu
- La page affiche une grille responsive de boosters avec sidebar
- Au clic sur un booster :
- Une modale plein Ã©cran sâ€™ouvre
- Le booster pack sâ€™affiche et flippe automatiquement aprÃ¨s 800 ms
- Les 5 cartes apparaissent en ligne, centrÃ©es
- Deux boutons en dessous : â€œTout retournerâ€ et â€œAjouter Ã  ma collectionâ€
- Les cartes peuvent Ãªtre retournÃ©es individuellement ou toutes Ã  la fois
- Lâ€™ajout Ã  la collection gÃ¨re les cartes et les circuits via Supabase

ğŸ› ï¸ ProblÃ¨mes rencontrÃ©s et corrigÃ©s
- Modale trop petite â†’ corrigÃ©e avec layout fullscreen
- Cartes mal affichÃ©es â†’ corrigÃ© en passant card.data Ã  Card
- Boutons mal positionnÃ©s â†’ dÃ©placÃ©s sous la grille
- Erreur HMR CSS â†’ patch dans next.config.js
- Flip du booster sans affichage des cartes â†’ corrigÃ© avec loading et cards.length

âœ… Ã‰tat actuel
Tout fonctionne :
- Layout responsive
- 
- Animation fluide
- Ajout Ã  la collection
- UX propre et intuitive
Tu peux maintenant repartir sur un nouveau chat avec ce rÃ©sumÃ©, et je pourrai tâ€™aider Ã  continuer ou Ã  intÃ©grer dâ€™autres fonctionnalitÃ©s (sons, effets, transitions, etc.).
PrÃªt pour la suite ğŸ’ª



